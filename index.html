<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–®–∞—Ö–º–∞—Ç—ã —Å –≠–≤–æ–ª—é—Ü–∏–µ–π</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="settings-icon" onclick="showSettingsModal()" title="Settings">
        <div>
            <p>‚öôÔ∏è</p>
        </div>
    </div>
    <h1 id="game-title">Chess with Evolution</h1>
    <div class="subtitle">made by shrechochek</div>

    <div class="game-container">
        <div id="board"></div>

        <div class="sidebar">
            <div class="panel">
                <div class="turn-indicator" id="turn-display">Turn: White</div>
                <div id="piece-info">Select a piece...</div>
            </div>

            <div class="panel">
                <h3 id="move-history-title">Move History</h3>
                <div class="move-history" id="move-history"></div>
            </div>

            <button class="reset-btn" onclick="initGame()">New Game</button>

            <!-- Arrow Test Controls -->
            <!-- <div style="margin: 10px 0; text-align: center;">
                <button onclick="testArrows()" style="padding: 5px 10px; margin: 0 2px; font-size: 12px;">Test Arrows</button>
                <button onclick="clearArrows()" style="padding: 5px 10px; margin: 0 2px; font-size: 12px;">Clear Arrows</button>
            </div> -->

            <!-- Move Navigation Controls -->
            <div class="move-navigation" style="display: flex; gap: 5px; margin: 10px 0; justify-content: center;">
                <button class="nav-btn" onclick="goToStart()" title="" disabled id="nav-start">‚èÆÔ∏è</button>
                <button class="nav-btn" onclick="goBack()" title="" disabled id="nav-back">‚¨ÖÔ∏è</button>
                <span class="move-counter" id="move-counter" style="font-size: 14px; align-self: center; min-width: 60px; text-align: center;">0/0</span>
                <button class="nav-btn" onclick="goForward()" title="" disabled id="nav-forward">‚û°Ô∏è</button>
                <button class="nav-btn" onclick="goToEnd()" title="" disabled id="nav-end">‚è≠Ô∏è</button>
            </div>

            <div class="mod-upload-container">
                <label for="mod-input" class="mod-upload-label">Load Mod</label>
                <input type="file" id="mod-input" webkitdirectory directory multiple onchange="loadMod(this)">
            </div>
        </div>
    </div>

    <div id="modal-overlay">
        <div class="modal-content">
            <h2 id="modal-title">Title</h2>
            <p id="modal-subtitle">Text</p>
            <div class="modal-options" id="modal-container"></div>
        </div>
    </div>

    <div id="settings-modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 200; justify-content: center; align-items: center; backdrop-filter: blur(5px);">
        <div class="modal-content" style="max-width: 400px;">
            <h2>Settings</h2>
            <div style="margin-top: 20px;">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">Language:</label>
                    <select id="language-select" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd; background: white; color: #333;">
                        <option value="en">English</option>
                        <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                    </select>
                </div>

                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">Game Tools:</label>
                    <button onclick="openPositionEditor()" style="width: 100%; padding: 10px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; margin-bottom: 8px;">
                        üìù <span id="position-editor-btn-text">Position Editor</span>
                    </button>
                </div>

                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button onclick="closeSettingsModal()" style="padding: 8px 16px; border: 1px solid #ddd; background: white; border-radius: 4px; cursor: pointer;">Cancel</button>
                    <button onclick="saveSettings()" style="padding: 8px 16px; background: #f1c40f; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Position Editor Modal -->
    <div id="position-editor-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 300; justify-content: center; align-items: center; backdrop-filter: blur(5px);">
        <div class="modal-content" style="max-width: 1200px; width: 95%; max-height: 90vh; overflow-y: auto;">
            <h2 style="margin-bottom: 20px;">Position Editor</h2>

            <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                <!-- Piece Selection Panel -->
                <div style="flex: 1; min-width: 250px;">
                    <h3 style="margin-bottom: 15px; color: #f1c40f;" id="piece-selection-title">Piece Selection</h3>

                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: bold;">Color:</label>
                        <div style="display: flex; gap: 10px;">
                            <button id="select-white-pieces" style="flex: 1; padding: 8px; background: #f1c40f; color: #333; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">White</button>
                            <button id="select-black-pieces" style="flex: 1; padding: 8px; background: #34495e; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">Black</button>
                        </div>
                    </div>

                    <div id="piece-selection-panel" style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 10px; background: rgba(255,255,255,0.05);">
                        <!-- Pieces will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Board Preview -->
                <div style="flex: 2;">
                    <h3 style="margin-bottom: 15px; color: #f1c40f;" id="board-position-title">Board Position</h3>
                    <div id="editor-board" style="display: grid; grid-template-columns: repeat(8, 40px); grid-template-rows: repeat(8, 40px); border: 4px solid #34495e; margin: 0 auto; width: fit-content; user-select: none; box-shadow: 0 10px 20px rgba(0,0,0,0.3);">
                        <!-- Board cells will be populated by JavaScript -->
                    </div>

                    <div style="margin-top: 15px; text-align: center;">
                        <label style="display: block; margin-bottom: 8px; font-weight: bold;">Turn:</label>
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            <button id="set-white-turn" style="padding: 8px 16px; background: #f1c40f; color: #333; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;" data-turn-text="white">White to move</button>
                            <button id="set-black-turn" style="padding: 8px 16px; background: #34495e; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;" data-turn-text="black">Black to move</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div style="display: flex; gap: 10px; justify-content: space-between; flex-wrap: wrap; margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                <div style="display: flex; gap: 10px;">
                    <button onclick="clearEditorBoard()" style="padding: 10px 15px; background: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;" data-action="clear">üóëÔ∏è Clear Board</button>
                    <button onclick="loadStandardPosition()" style="padding: 10px 15px; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer;" data-action="standard">‚ôüÔ∏è Standard Position</button>
                </div>

                <div style="display: flex; gap: 10px;">
                    <button onclick="savePosition()" style="padding: 10px 15px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;" data-action="save">üíæ Save Position</button>
                    <button onclick="loadPosition()" style="padding: 10px 15px; background: #9b59b6; color: white; border: none; border-radius: 4px; cursor: pointer;" data-action="load">üìÇ Load Position</button>
                    <button onclick="applyPosition()" style="padding: 10px 15px; background: #f39c12; color: #333; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;" data-action="apply">‚úì Apply to Game</button>
                    <button onclick="closePositionEditor()" style="padding: 10px 15px; border: 1px solid #ddd; background: white; border-radius: 4px; cursor: pointer;" data-action="cancel">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
